<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemoryBench | Benchmark Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Share+Tech+Mono&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        :root {
            /* RETRO NEON COLOR PALETTE */
            --bg-primary: #050508;
            --bg-secondary: #0a0a12;
            --bg-card: #0d0d18;
            --bg-hover: #12121f;
            --border-color: #1a1a2e;
            --border-hover: #00ffff;
            
            /* Neon colors */
            --neon-cyan: #00ffff;
            --neon-cyan-dim: #00cccc;
            --neon-pink: #ff00ff;
            --neon-pink-dim: #cc00cc;
            --neon-blue: #00aaff;
            --neon-green: #00ff88;
            --neon-yellow: #ffff00;
            --neon-orange: #ff8800;
            --neon-red: #ff0055;
            
            /* Glow effects */
            --glow-cyan: 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 40px #00ffff;
            --glow-cyan-soft: 0 0 5px rgba(0, 255, 255, 0.3), 0 0 10px rgba(0, 255, 255, 0.2);
            --glow-pink: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 40px #ff00ff;
            --glow-pink-soft: 0 0 5px rgba(255, 0, 255, 0.3), 0 0 10px rgba(255, 0, 255, 0.2);
            
            /* Text colors */
            --text-primary: #e0e0e0;
            --text-secondary: #8888aa;
            --text-muted: #555577;
            
            /* Accent colors for providers */
            --accent-blue: #00aaff;
            --accent-cyan: #00ffff;
            --accent-purple: #aa00ff;
            --accent-green: #00ff88;
            --accent-orange: #ff8800;
            --accent-yellow: #ffff00;
            --accent-red: #ff0055;
            
            /* Provider colors - neon style */
            --color-supermemory: #00ffff;
            --color-zep: #ff8800;
            --color-mem0: #ffff00;
            --color-fullcontext: #aa00ff;
            --color-langchain: #00ff88;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Share Tech Mono', 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }

        /* CRT Scan Lines Overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.15) 2px,
                rgba(0, 0, 0, 0.15) 4px
            );
            pointer-events: none;
            z-index: 9999;
        }

        /* Grid Background */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px),
                radial-gradient(ellipse 100% 60% at 50% 0%, rgba(0, 255, 255, 0.08), transparent 70%),
                radial-gradient(ellipse 80% 50% at 0% 50%, rgba(255, 0, 255, 0.05), transparent 70%),
                radial-gradient(ellipse 80% 50% at 100% 50%, rgba(0, 170, 255, 0.05), transparent 70%);
            background-size: 60px 60px, 60px 60px, 100% 100%, 100% 100%, 100% 100%;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 24px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 48px;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .logo-icon {
            width: 56px;
            height: 56px;
            background: transparent;
            border: 2px solid var(--neon-cyan);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: var(--glow-cyan-soft), inset 0 0 20px rgba(0, 255, 255, 0.1);
            animation: pulse-glow 3s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: var(--glow-cyan-soft), inset 0 0 20px rgba(0, 255, 255, 0.1); }
            50% { box-shadow: 0 0 15px rgba(0, 255, 255, 0.5), 0 0 30px rgba(0, 255, 255, 0.3), inset 0 0 25px rgba(0, 255, 255, 0.15); }
        }

        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 32px;
            font-weight: 700;
            color: var(--neon-cyan);
            text-shadow: var(--glow-cyan-soft);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .subtitle {
            font-family: 'Share Tech Mono', monospace;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 400;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* Benchmark Tabs */
        .tabs-container {
            display: flex;
            justify-content: center;
            margin-bottom: 32px;
        }

        .tabs {
            display: inline-flex;
            background: rgba(0, 255, 255, 0.03);
            border-radius: 0;
            padding: 4px;
            gap: 0;
            border: 1px solid var(--neon-cyan);
            box-shadow: var(--glow-cyan-soft);
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }

        .tab {
            padding: 14px 32px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-family: 'Orbitron', sans-serif;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
        }

        .tab::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: var(--neon-cyan);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .tab:hover {
            color: var(--neon-cyan);
            text-shadow: var(--glow-cyan-soft);
        }

        .tab:hover::before {
            width: 60%;
        }

        .tab.active {
            background: rgba(0, 255, 255, 0.1);
            color: var(--neon-cyan);
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
        }

        .tab.active::before {
            width: 80%;
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        /* Provider Controls */
        .controls {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 0;
            padding: 24px;
            margin-bottom: 32px;
            clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 15px, 100% 100%, 15px 100%, 0 calc(100% - 15px));
        }

        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .controls-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            font-weight: 600;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: var(--glow-cyan-soft);
        }

        .formal-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .formal-toggle input {
            width: 18px;
            height: 18px;
            accent-color: var(--neon-cyan);
            cursor: pointer;
        }

        .provider-toggles {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .provider-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 18px;
            background: transparent;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
        }

        .provider-toggle:hover {
            border-color: var(--neon-cyan);
            background: rgba(0, 255, 255, 0.05);
            box-shadow: var(--glow-cyan-soft);
        }

        .provider-toggle.active {
            border-color: var(--neon-cyan);
            background: rgba(0, 255, 255, 0.1);
            box-shadow: var(--glow-cyan-soft);
        }

        .provider-toggle input {
            display: none;
        }

        .provider-color {
            width: 14px;
            height: 14px;
            border-radius: 0;
            flex-shrink: 0;
            box-shadow: 0 0 8px currentColor;
        }

        .provider-name {
            font-family: 'Share Tech Mono', monospace;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .provider-toggle:not(.active) .provider-name {
            color: var(--text-muted);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px));
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-cyan), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: var(--glow-cyan-soft);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-label {
            font-family: 'Share Tech Mono', monospace;
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-value.highlight {
            color: var(--neon-cyan);
            text-shadow: var(--glow-cyan-soft);
        }

        .stat-suffix {
            font-size: 16px;
            color: var(--text-secondary);
        }

        /* Chart Section */
        .chart-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 32px;
            margin-bottom: 32px;
            clip-path: polygon(0 0, calc(100% - 20px) 0, 100% 20px, 100% 100%, 20px 100%, 0 calc(100% - 20px));
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .chart-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            font-weight: 600;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: var(--glow-cyan-soft);
        }

        .chart-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .chart-container {
            position: relative;
            height: 400px;
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 24px;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 0;
        }

        .legend-label {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Detailed Results Table */
        .details-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 32px;
            margin-bottom: 32px;
            clip-path: polygon(0 0, calc(100% - 20px) 0, 100% 20px, 100% 100%, 20px 100%, 0 calc(100% - 20px));
        }

        .details-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: var(--neon-cyan);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: var(--glow-cyan-soft);
        }

        .provider-details {
            display: grid;
            gap: 20px;
        }

        .provider-detail-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s ease;
            clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
        }

        .provider-detail-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: var(--glow-cyan-soft);
        }

        .provider-detail-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            background: rgba(0, 255, 255, 0.02);
        }

        .provider-detail-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .provider-detail-meta {
            font-size: 11px;
            color: var(--text-muted);
            margin-left: auto;
            font-family: 'Share Tech Mono', monospace;
            letter-spacing: 1px;
        }

        .provider-detail-body {
            padding: 16px 20px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0, 255, 255, 0.1);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .detail-value {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loading & Error States */
        .loading, .no-data {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-muted);
            font-size: 14px;
            letter-spacing: 2px;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 2px solid var(--border-color);
            border-top-color: var(--neon-cyan);
            border-right-color: var(--neon-pink);
            border-radius: 0;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
            box-shadow: var(--glow-cyan-soft);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error {
            background: rgba(255, 0, 85, 0.1);
            border: 1px solid var(--neon-red);
            color: var(--neon-red);
            padding: 20px;
            text-shadow: 0 0 10px rgba(255, 0, 85, 0.5);
        }

        /* Collapsible Sections */
        .collapsible {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            margin-bottom: 24px;
            overflow: hidden;
            clip-path: polygon(0 0, calc(100% - 15px) 0, 100% 15px, 100% 100%, 15px 100%, 0 calc(100% - 15px));
            transition: all 0.3s ease;
        }

        .collapsible:hover {
            border-color: rgba(0, 255, 255, 0.3);
        }

        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            background: rgba(0, 255, 255, 0.02);
        }

        .collapsible-header:hover {
            background: rgba(0, 255, 255, 0.05);
        }

        .collapsible-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            font-weight: 600;
            color: var(--neon-cyan);
            display: flex;
            align-items: center;
            gap: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .collapsible-title .icon {
            font-size: 16px;
            filter: drop-shadow(0 0 5px var(--neon-cyan));
        }

        .collapsible-toggle {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--neon-cyan);
            transition: transform 0.3s ease;
            font-size: 12px;
        }

        .collapsible.collapsed .collapsible-toggle {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            padding: 0 24px 24px 24px;
            transition: all 0.3s ease;
        }

        .collapsible.collapsed .collapsible-content {
            display: none;
        }

        /* Dataset Statistics Section */
        .dataset-stats-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 24px;
            margin-bottom: 32px;
        }

        .dataset-stats-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: var(--neon-cyan);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: var(--glow-cyan-soft);
        }

        .dataset-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .stats-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 20px;
            transition: all 0.3s ease;
            clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
        }

        .stats-card:hover {
            border-color: var(--neon-cyan);
            box-shadow: var(--glow-cyan-soft);
        }

        .stats-card-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .stats-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .stats-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stats-item-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stats-item-value {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
        }

        .stats-item-value.highlight {
            color: var(--neon-cyan);
            font-size: 16px;
            text-shadow: var(--glow-cyan-soft);
        }

        .category-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
        }

        .category-bar-label {
            font-size: 11px;
            color: var(--text-secondary);
            min-width: 140px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .category-bar-track {
            flex: 1;
            height: 6px;
            background: var(--bg-primary);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .category-bar-fill {
            height: 100%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px currentColor;
        }

        .category-bar-value {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Share Tech Mono', monospace;
            min-width: 80px;
            text-align: right;
            margin-bottom: 24px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 24px 16px;
            }
            
            .tabs {
                width: 100%;
                flex-direction: column;
                clip-path: none;
            }
            
            .tab {
                text-align: center;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Run History */
        .history-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 32px;
            margin-bottom: 32px;
            clip-path: polygon(0 0, calc(100% - 20px) 0, 100% 20px, 100% 100%, 20px 100%, 0 calc(100% - 20px));
        }

        .history-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: var(--neon-cyan);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: var(--glow-cyan-soft);
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
        }

        .history-table th,
        .history-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .history-table th {
            font-family: 'Orbitron', sans-serif;
            font-size: 10px;
            font-weight: 600;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .history-table td {
            font-size: 13px;
            color: var(--text-primary);
        }

        .history-table tr:hover td {
            background: rgba(0, 255, 255, 0.05);
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            font-size: 10px;
            font-weight: 500;
            font-family: 'Share Tech Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid;
        }

        .badge-formal {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--neon-green);
            color: var(--neon-green);
        }

        .badge-test {
            background: rgba(136, 136, 170, 0.1);
            border-color: var(--text-muted);
            color: var(--text-muted);
        }

        /* Neon Glow Animations */
        @keyframes neon-flicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
                text-shadow: var(--glow-cyan-soft);
                opacity: 1;
            }
            20%, 24%, 55% {
                text-shadow: none;
                opacity: 0.8;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border: 1px solid var(--neon-cyan);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 255, 0.2);
            box-shadow: var(--glow-cyan-soft);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">üìä</div>
                <span class="logo-text">MemoryBench</span>
            </div>
            <p class="subtitle">Comparative Performance Analysis Across Memory Providers</p>
        </header>

        <!-- Benchmark Tabs -->
        <div class="tabs-container">
            <div class="tabs" id="benchmark-tabs">
                <!-- Populated dynamically -->
            </div>
        </div>

        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            Loading benchmark data...
        </div>

        <!-- Error State -->
        <div id="error" class="error" style="display: none;"></div>

        <!-- NoLiMa Tab -->
        <div id="nolima-content" class="tab-content">
            <!-- Provider Controls -->
            <div class="collapsible" data-section="nolima-controls">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">‚öôÔ∏è</span> Provider Controls</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="controls-header" style="margin-bottom: 16px;">
                        <label class="formal-toggle">
                            <input type="checkbox" id="nolima-formal-only" checked>
                            Formal runs only
                        </label>
                    </div>
                    <div id="nolima-providers" class="provider-toggles"></div>
                </div>
            </div>

            <!-- Stats -->
            <div class="collapsible" data-section="nolima-stats-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìä</span> Overview Stats</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="nolima-stats" class="stats-grid" style="margin-bottom: 0;"></div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="collapsible" data-section="nolima-chart-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìà</span> Accuracy by Context Length</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="chart-container">
                        <canvas id="nolima-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Dataset Statistics -->
            <div class="collapsible collapsed" data-section="nolima-dataset-stats" id="nolima-dataset-stats">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìã</span> Dataset Statistics</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="dataset-stats-grid">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Provider Details -->
            <div class="collapsible collapsed" data-section="nolima-details" id="nolima-details">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üîç</span> Provider Details</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="provider-details"></div>
                </div>
            </div>
        </div>

        <!-- LongMemEval Tab -->
        <div id="longmemeval-content" class="tab-content">
            <!-- Provider Controls -->
            <div class="collapsible" data-section="longmemeval-controls">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">‚öôÔ∏è</span> Provider Controls</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="controls-header" style="margin-bottom: 16px;">
                        <label class="formal-toggle">
                            <input type="checkbox" id="longmemeval-formal-only" checked>
                            Formal runs only
                        </label>
                </div>
                    <div id="longmemeval-providers" class="provider-toggles"></div>
                </div>
            </div>

            <!-- Stats -->
            <div class="collapsible" data-section="longmemeval-stats-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìä</span> Overview Stats</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="longmemeval-stats" class="stats-grid" style="margin-bottom: 0;"></div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="collapsible" data-section="longmemeval-chart-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìà</span> Accuracy by Question Type</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="chart-container">
                        <canvas id="longmemeval-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Dataset Statistics -->
            <div class="collapsible collapsed" data-section="longmemeval-dataset-stats" id="longmemeval-dataset-stats">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìã</span> Dataset Statistics</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="dataset-stats-grid">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Provider Details -->
            <div class="collapsible collapsed" data-section="longmemeval-details" id="longmemeval-details">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üîç</span> Provider Details</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="provider-details"></div>
                </div>
            </div>
        </div>

        <!-- LoCoMo Tab -->
        <div id="locomo-content" class="tab-content">
            <!-- Provider Controls -->
            <div class="collapsible" data-section="locomo-controls">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">‚öôÔ∏è</span> Provider Controls</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="controls-header" style="margin-bottom: 16px;">
                        <label class="formal-toggle">
                            <input type="checkbox" id="locomo-formal-only" checked>
                            Formal runs only
                        </label>
                    </div>
                    <div id="locomo-providers" class="provider-toggles"></div>
                </div>
            </div>

            <!-- Stats -->
            <div class="collapsible" data-section="locomo-stats-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìä</span> Overview Stats</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="locomo-stats" class="stats-grid" style="margin-bottom: 0;"></div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="collapsible" data-section="locomo-chart-section">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìà</span> Accuracy by Category</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="chart-container">
                        <canvas id="locomo-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Dataset Statistics - Moved below chart -->
            <div class="collapsible collapsed" data-section="locomo-dataset-stats" id="locomo-dataset-stats">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üìã</span> Dataset Statistics</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="dataset-stats-grid">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Category Distribution -->
            <div class="collapsible collapsed" data-section="locomo-distribution">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üéØ</span> Question Distribution</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div id="locomo-category-distribution"></div>
                </div>
            </div>

            <!-- Provider Details -->
            <div class="collapsible collapsed" data-section="locomo-details" id="locomo-details">
                <div class="collapsible-header" onclick="toggleCollapsible(this)">
                    <span class="collapsible-title"><span class="icon">üîç</span> Provider Details</span>
                    <span class="collapsible-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <div class="provider-details"></div>
                </div>
            </div>
        </div>

        <!-- No Data State -->
        <div id="no-data" class="no-data" style="display: none;">
            <p>No benchmark results found.</p>
            <p style="margin-top: 8px; font-size: 14px;">Run some benchmarks with the <code>--formal</code> flag to see results here.</p>
        </div>
    </div>

    <script>
        // ============================================================================
        // State
        // ============================================================================
        
        let config = {};
        let allData = null;
        let charts = {};
        let activeTab = 'nolima';
        let selectedProviders = {
            nolima: new Set(),
            longmemeval: new Set(),
            locomo: new Set(),
        };

        const PROVIDER_COLORS = {
            supermemory: '#00ffff',
            zep: '#ff8800',
            mem0: '#ffff00',
            fullcontext: '#aa00ff',
            langchain: '#00ff88',
        };

        // ============================================================================
        // Collapsible Sections
        // ============================================================================

        function toggleCollapsible(headerElement) {
            const section = headerElement.parentElement;
            section.classList.toggle('collapsed');
            
            // Save state to localStorage
            const sectionId = section.dataset.section;
            if (sectionId) {
                const collapsed = section.classList.contains('collapsed');
                localStorage.setItem(`collapse-${sectionId}`, collapsed);
            }
        }

        function restoreCollapsibleStates() {
            document.querySelectorAll('.collapsible[data-section]').forEach(section => {
                const sectionId = section.dataset.section;
                const saved = localStorage.getItem(`collapse-${sectionId}`);
                if (saved === 'true') {
                    section.classList.add('collapsed');
                } else if (saved === 'false') {
                    section.classList.remove('collapsed');
                }
            });
        }

        // ============================================================================
        // Initialization
        // ============================================================================

        async function init() {
            try {
                // Load config
                const configRes = await fetch('/api/config');
                config = await configRes.json();
                Object.assign(PROVIDER_COLORS, config.providerColors || {});

                // Load data
                await loadData();
                
                // Setup tabs
                setupTabs();
                
                // Restore collapsible states
                restoreCollapsibleStates();
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
            } catch (error) {
                console.error('Init error:', error);
                document.getElementById('loading').style.display = 'none';
                showError('Failed to load benchmark data: ' + error.message);
            }
        }

        let datasetStats = null;

        async function loadData() {
            const formalOnly = true;
            const [aggregatedRes, statsRes] = await Promise.all([
                fetch(`/api/aggregated?formalOnly=${formalOnly}`),
                fetch('/api/dataset-stats'),
            ]);
            
            allData = await aggregatedRes.json();
            datasetStats = await statsRes.json();
            
            if (!allData.benchmarks || allData.benchmarks.length === 0) {
                document.getElementById('no-data').style.display = 'block';
                return;
            }

            // Initialize selected providers (all on by default)
            allData.noLiMa.forEach(r => selectedProviders.nolima.add(r.provider));
            allData.longMemEval.forEach(r => selectedProviders.longmemeval.add(r.provider));
            allData.loCoMo.forEach(r => selectedProviders.locomo.add(r.provider));

            renderAll();
        }

        function showError(message) {
            const errorEl = document.getElementById('error');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
        }

        // ============================================================================
        // Tabs
        // ============================================================================

        function setupTabs() {
            const tabsContainer = document.getElementById('benchmark-tabs');
            const benchmarks = [
                { id: 'nolima', label: 'NoLiMa' },
                { id: 'longmemeval', label: 'LongMemEval' },
                { id: 'locomo', label: 'LoCoMo' },
            ];

            tabsContainer.innerHTML = benchmarks.map(b => `
                <button class="tab ${b.id === activeTab ? 'active' : ''}" data-tab="${b.id}">
                    ${b.label}
                </button>
            `).join('');

            // Add click handlers
            tabsContainer.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    setActiveTab(tab.dataset.tab);
                });
            });

            // Show initial tab
            setActiveTab(activeTab);
        }

        function setActiveTab(tabId) {
            activeTab = tabId;
            
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabId);
            });

            // Update content visibility
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.toggle('active', content.id === `${tabId}-content`);
            });
        }

        // ============================================================================
        // Rendering
        // ============================================================================

        function renderAll() {
            renderDatasetStats();
            renderNoLiMa();
            renderLongMemEval();
            renderLoCoMo();
        }

        // ============================================================================
        // Dataset Statistics
        // ============================================================================

        function renderDatasetStats() {
            if (!datasetStats) return;
            
            // NoLiMa Dataset Stats
            if (datasetStats.nolima) {
                const stats = datasetStats.nolima;
                const container = document.querySelector('#nolima-dataset-stats .dataset-stats-grid');
                if (container) {
                    const lengthColors = ['#00ffff', '#aa00ff', '#00ff88', '#ff8800', '#ff0055'];
                    
                    container.innerHTML = `
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 700; color: var(--neon-cyan); text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);">${stats.totalTests}</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 2px;">Total Test Cases</div>
                            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0, 255, 255, 0.2);">
                                <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${stats.testsPerLength}</span>
                                <span style="font-size: 10px; color: var(--text-muted); margin-left: 6px; text-transform: uppercase; letter-spacing: 1px;">per context</span>
                            </div>
                        </div>
                        
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 700; color: var(--neon-pink); text-shadow: 0 0 20px rgba(255, 0, 255, 0.5);">${stats.contextLengths.length}</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 2px;">Context Lengths</div>
                            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0, 255, 255, 0.2);">
                                ${stats.contextLengths.map((len, i) => `
                                    <div style="padding: 6px 14px; background: transparent; border: 1px solid ${lengthColors[i]}; box-shadow: 0 0 10px ${lengthColors[i]}40;">
                                        <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: ${lengthColors[i]}; text-shadow: 0 0 8px ${lengthColors[i]}80;">${len}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 700; color: var(--neon-green); text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);">32K</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 2px;">Max Context</div>
                            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0, 255, 255, 0.2);">
                                <span style="font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Memory retrieval at scale</span>
                            </div>
                        </div>
                    `;
                }
            }
            
            // LongMemEval Dataset Stats
            if (datasetStats.longmemeval) {
                const stats = datasetStats.longmemeval;
                const container = document.querySelector('#longmemeval-dataset-stats .dataset-stats-grid');
                if (container) {
                    const typeColors = {
                        'single-session-user': '#00ffff',
                        'single-session-assistant': '#aa00ff',
                        'single-session-preference': '#00aaff',
                        'knowledge-update': '#00ff88',
                        'temporal-reasoning': '#ff8800',
                        'multi-session': '#ff0055',
                    };
                    
                    container.innerHTML = `
                        <div class="stats-card" style="text-align: center;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 700; color: var(--neon-cyan); text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);">${stats.totalQuestions}</div>
                            <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 2px;">Total Questions</div>
                            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0, 255, 255, 0.2);">
                                <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${stats.questionTypes.length}</span>
                                <span style="font-size: 10px; color: var(--text-muted); margin-left: 6px; text-transform: uppercase; letter-spacing: 1px;">types</span>
                            </div>
                        </div>
                        
                        <div class="stats-card" style="text-align: center; grid-column: span 2;">
                            <div style="font-family: 'Orbitron', sans-serif; font-size: 14px; font-weight: 600; color: var(--neon-cyan); margin-bottom: 16px; text-transform: uppercase; letter-spacing: 2px;">Question Distribution</div>
                            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
                                ${stats.questionTypes.map(qt => `
                                    <div style="padding: 8px 14px; background: transparent; border: 1px solid ${typeColors[qt.type]}; box-shadow: 0 0 10px ${typeColors[qt.type]}40;">
                                        <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: ${typeColors[qt.type]}; text-shadow: 0 0 8px ${typeColors[qt.type]}80;">${qt.count}</span>
                                        <span style="font-size: 10px; color: var(--text-muted); margin-left: 8px; text-transform: uppercase; letter-spacing: 1px;">${qt.label.replace('Single-Session ', 'SS ')}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            // LoCoMo Dataset Stats - Compact visual cards only
            if (datasetStats.locomo) {
                const stats = datasetStats.locomo;
                const container = document.querySelector('#locomo-dataset-stats .dataset-stats-grid');
                
                // Category colors - neon style
                const categoryColors = {
                    1: '#aa00ff',  // Multi-hop - Neon Purple
                    2: '#00aaff',  // Temporal - Neon Blue
                    3: '#00ff88',  // Open Domain - Neon Green
                    4: '#ff8800',  // Single-hop - Neon Orange
                    5: '#ff0055',  // Adversarial - Neon Red
                };
                
                // Compact stats cards - no text labels, just visual
                container.innerHTML = `
                    <div class="stats-card" style="text-align: center;">
                        <div style="font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 700; color: var(--neon-cyan); text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);">${stats.conversations.total}</div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 2px;">Conversations</div>
                        <div style="display: flex; justify-content: center; gap: 20px; margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0, 255, 255, 0.2);">
                            <div><span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${stats.conversations.avgSessions}</span><br><span style="font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Sessions</span></div>
                            <div><span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${stats.conversations.avgTurns}</span><br><span style="font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Turns</span></div>
                            <div><span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${(stats.conversations.avgTokens/1000).toFixed(1)}K</span><br><span style="font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Tokens</span></div>
                        </div>
                    </div>
                    
                    <div class="stats-card" style="text-align: center;">
                        <div style="font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 700; color: var(--neon-cyan); text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);">${stats.questions.total.toLocaleString()}</div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 2px;">Questions</div>
                        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0, 255, 255, 0.2);">
                            ${stats.questions.byCategory.map(cat => `
                                <div style="padding: 6px 12px; background: transparent; border: 1px solid ${categoryColors[cat.category]}; box-shadow: 0 0 10px ${categoryColors[cat.category]}40;">
                                    <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: ${categoryColors[cat.category]}; text-shadow: 0 0 8px ${categoryColors[cat.category]}80;">${cat.count}</span>
                                    <span style="font-size: 9px; color: var(--text-muted); margin-left: 4px; text-transform: uppercase; letter-spacing: 1px;">${cat.name.split(' ')[0]}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="stats-card" style="text-align: center;">
                        <div style="font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 700; color: var(--neon-pink); text-shadow: 0 0 20px rgba(255, 0, 255, 0.5);">${stats.multimodal.totalImages}</div>
                        <div style="font-size: 11px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 2px;">Images</div>
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(0, 255, 255, 0.2);">
                            <span style="font-family: 'Orbitron', sans-serif; font-weight: 600; color: var(--text-primary);">${stats.multimodal.avgImages}</span>
                            <span style="font-size: 9px; color: var(--text-muted); margin-left: 6px; text-transform: uppercase; letter-spacing: 1px;">per conv</span>
                        </div>
                    </div>
                `;
                
                // Also populate the distribution section
                const distContainer = document.getElementById('locomo-category-distribution');
                if (distContainer) {
                    distContainer.innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; padding: 20px 0;">
                            ${stats.questions.byCategory.map(cat => `
                                <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border: 1px solid ${categoryColors[cat.category]}; box-shadow: 0 0 15px ${categoryColors[cat.category]}30; clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));">
                                    <div style="font-family: 'Orbitron', sans-serif; font-size: 28px; font-weight: 700; color: ${categoryColors[cat.category] || '#6B7280'}; text-shadow: 0 0 15px ${categoryColors[cat.category]}80;">
                                        ${cat.count}
                                    </div>
                                    <div style="font-size: 10px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px;">
                                        ${cat.name}
                                    </div>
                                    <div style="font-family: 'Share Tech Mono', monospace; font-size: 13px; color: var(--text-secondary); margin-top: 4px;">
                                        ${cat.percentage}%
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
            }
        }

        function renderNoLiMa() {
            const data = allData.noLiMa;
            if (data.length === 0) return;

            // Render provider toggles
            renderProviderToggles('nolima', data);
            
            // Render stats
            renderStats('nolima', data);
            
            // Render chart
            renderNoLiMaChart(data);
            
            // Render details
            renderNoLiMaDetails(data);
        }

        function renderLongMemEval() {
            const data = allData.longMemEval;
            if (data.length === 0) return;

            renderProviderToggles('longmemeval', data);
            renderStats('longmemeval', data);
            renderLongMemEvalChart(data);
            renderLongMemEvalDetails(data);
        }

        function renderLoCoMo() {
            const data = allData.loCoMo;
            if (data.length === 0) return;

            renderProviderToggles('locomo', data);
            renderStats('locomo', data);
            renderLoCoMoChart(data);
            renderLoCoMoDetails(data);
        }

        function renderProviderToggles(benchmark, data) {
            const container = document.getElementById(`${benchmark}-providers`);
            const providers = [...new Set(data.map(r => r.provider))];
            
            container.innerHTML = providers.map(provider => {
                const isActive = selectedProviders[benchmark].has(provider);
                const color = PROVIDER_COLORS[provider] || '#6B7280';
                return `
                    <label class="provider-toggle ${isActive ? 'active' : ''}" data-provider="${provider}">
                        <input type="checkbox" ${isActive ? 'checked' : ''}>
                        <span class="provider-color" style="background: ${color}"></span>
                        <span class="provider-name">${provider}</span>
                    </label>
                `;
            }).join('');

            // Add change handlers
            container.querySelectorAll('.provider-toggle').forEach(toggle => {
                toggle.addEventListener('click', (e) => {
                    const provider = toggle.dataset.provider;
                    const checkbox = toggle.querySelector('input');
                    
                    if (e.target !== checkbox) {
                        checkbox.checked = !checkbox.checked;
                    }
                    
                    toggle.classList.toggle('active', checkbox.checked);
                    
                    if (checkbox.checked) {
                        selectedProviders[benchmark].add(provider);
                    } else {
                        selectedProviders[benchmark].delete(provider);
                    }
                    
                    // Re-render chart, stats, and details
                    if (benchmark === 'nolima') {
                        renderNoLiMaChart(allData.noLiMa);
                        renderStats('nolima', allData.noLiMa);
                        renderNoLiMaDetails(allData.noLiMa);
                    } else if (benchmark === 'longmemeval') {
                        renderLongMemEvalChart(allData.longMemEval);
                        renderStats('longmemeval', allData.longMemEval);
                        renderLongMemEvalDetails(allData.longMemEval);
                    } else if (benchmark === 'locomo') {
                        renderLoCoMoChart(allData.loCoMo);
                        renderStats('locomo', allData.loCoMo);
                        renderLoCoMoDetails(allData.loCoMo);
                    }
                });
            });
        }

        function renderStats(benchmark, data) {
            const container = document.getElementById(`${benchmark}-stats`);
            const filteredData = data.filter(r => selectedProviders[benchmark].has(r.provider));
            
            if (filteredData.length === 0) {
                container.innerHTML = '';
                return;
            }

            // Find best accuracy
            const bestAccuracy = Math.max(...filteredData.map(r => r.accuracy));
            const bestProvider = filteredData.find(r => r.accuracy === bestAccuracy);
            
            // Total questions
            const totalQuestions = filteredData.reduce((sum, r) => sum + (r.totalTests || r.totalQuestions || 0), 0);
            
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">Best Accuracy</div>
                    <div class="stat-value highlight" style="font-family: 'Orbitron', sans-serif;">${bestAccuracy.toFixed(1)}<span class="stat-suffix">%</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Top Provider</div>
                    <div class="stat-value" style="font-family: 'Orbitron', sans-serif; font-size: 18px; color: var(--neon-pink); text-shadow: 0 0 10px rgba(255, 0, 255, 0.5);">${bestProvider?.provider?.toUpperCase() || '-'}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Providers</div>
                    <div class="stat-value" style="font-family: 'Orbitron', sans-serif;">${filteredData.length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Tests</div>
                    <div class="stat-value" style="font-family: 'Orbitron', sans-serif;">${totalQuestions.toLocaleString()}</div>
                </div>
            `;
        }

        // ============================================================================
        // Charts
        // ============================================================================

        function renderNoLiMaChart(data) {
            const ctx = document.getElementById('nolima-chart');
            const filteredData = data.filter(r => selectedProviders.nolima.has(r.provider));
            
            if (charts.nolima) charts.nolima.destroy();
            
            // Handle no data case
            if (filteredData.length === 0) {
                charts.nolima = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: [], datasets: [] },
                    options: getChartOptions('Accuracy (%)', [])
                });
                return;
            }
            
            // Context lengths as labels
            const labels = ['1K', '4K', '8K', '16K', '32K'];
            
            const datasets = filteredData.map(run => ({
                label: run.provider,
                data: labels.map(len => {
                    const ctxData = run.byContextLength?.find(c => c.contextLength === len);
                    return ctxData ? ctxData.accuracy : 0;
                }),
                backgroundColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderWidth: 0,
                borderRadius: 4,
            }));

            charts.nolima = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: getChartOptions('Accuracy (%)', datasets)
            });
        }

        function renderLongMemEvalChart(data) {
            const ctx = document.getElementById('longmemeval-chart');
            const filteredData = data.filter(r => selectedProviders.longmemeval.has(r.provider));
            
            if (charts.longmemeval) charts.longmemeval.destroy();
            
            // Handle no data case
            if (filteredData.length === 0) {
                charts.longmemeval = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: [], datasets: [] },
                    options: getChartOptions('Accuracy (%)', [])
                });
                return;
            }
            
            const labelMap = config.longMemEvalLabels || {
                'single-session-user': 'Single-Session User',
                'single-session-assistant': 'Single-Session Assistant',
                'single-session-preference': 'Single-Session Preference',
                'knowledge-update': 'Knowledge Update',
                'temporal-reasoning': 'Temporal Reasoning',
                'multi-session': 'Multi-Session',
            };
            
            const questionTypes = Object.keys(labelMap);
            const labels = questionTypes.map(qt => labelMap[qt]);
            
            const datasets = filteredData.map(run => ({
                label: run.provider,
                data: questionTypes.map(qt => {
                    const qtype = run.byQuestionType?.find(q => q.questionType === qt);
                    return qtype ? qtype.accuracy : 0;
                }),
                backgroundColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderWidth: 0,
                borderRadius: 4,
            }));

            charts.longmemeval = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: getChartOptions('Accuracy (%)', datasets)
            });
        }

        function renderLoCoMoChart(data) {
            const ctx = document.getElementById('locomo-chart');
            const filteredData = data.filter(r => selectedProviders.locomo.has(r.provider));
            
            if (charts.locomo) charts.locomo.destroy();
            
            // Handle no data case
            if (filteredData.length === 0) {
                charts.locomo = new Chart(ctx, {
                    type: 'bar',
                    data: { labels: [], datasets: [] },
                    options: getChartOptions('Accuracy (%)', [])
                });
                return;
            }
            
            const categoryLabels = {
                1: 'Single-hop Factual',
                2: 'Temporal Reasoning',
                3: 'Multi-hop Reasoning',
                4: 'Simple Factual',
                5: 'Adversarial',
            };
            
            const categories = [1, 2, 3, 4, 5];
            const labels = categories.map(c => categoryLabels[c]);
            
            const datasets = filteredData.map(run => ({
                label: run.provider,
                data: categories.map(cat => {
                    const category = run.byCategory?.find(c => c.category === cat);
                    return category ? category.accuracy : 0;
                }),
                backgroundColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderColor: PROVIDER_COLORS[run.provider] || '#6B7280',
                borderWidth: 0,
                borderRadius: 4,
            }));

            charts.locomo = new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets },
                options: getChartOptions('Accuracy (%)', datasets)
            });
        }

        function getChartOptions(yAxisLabel, datasets = []) {
            // Calculate dynamic Y-axis based on data
            let allValues = [];
            datasets.forEach(ds => {
                if (ds.data) allValues = allValues.concat(ds.data.filter(v => v > 0));
            });
            
            // Set min to (lowest value - 10) floored to nearest 5, but not below 0
            // Set max to (highest value + 5) ceiled to nearest 5, but not above 100
            const minValue = allValues.length > 0 ? Math.min(...allValues) : 0;
            const maxValue = allValues.length > 0 ? Math.max(...allValues) : 100;
            
            const yMin = Math.max(0, Math.floor((minValue - 10) / 5) * 5);
            const yMax = Math.min(100, Math.ceil((maxValue + 5) / 5) * 5);
            
            return {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 500,
                    easing: 'easeOutQuart',
                },
                transitions: {
                    active: {
                        animation: {
                            duration: 250
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: {
                            color: '#00ffff',
                            font: { family: 'Orbitron', size: 11, weight: 500 },
                            padding: 20,
                            usePointStyle: true,
                            pointStyle: 'rect',
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(10, 10, 20, 0.95)',
                        titleColor: '#00ffff',
                        bodyColor: '#e0e0e0',
                        borderColor: '#00ffff',
                        borderWidth: 1,
                        padding: 14,
                        cornerRadius: 0,
                        titleFont: { family: 'Orbitron', weight: 600, size: 12 },
                        bodyFont: { family: 'Share Tech Mono', size: 13 },
                        displayColors: true,
                        boxPadding: 6,
                        callbacks: {
                            label: (ctx) => `${ctx.dataset.label}: ${ctx.raw.toFixed(1)}%`
                        }
                    }
                },
                scales: {
                    x: {
                        grid: {
                            color: 'rgba(0, 255, 255, 0.08)',
                            drawBorder: false,
                            lineWidth: 1,
                        },
                        ticks: {
                            color: '#8888aa',
                            font: { family: 'Share Tech Mono', size: 11 },
                            maxRotation: 45,
                            minRotation: 45,
                        },
                        border: {
                            color: 'rgba(0, 255, 255, 0.3)',
                        }
                    },
                    y: {
                        min: yMin,
                        max: yMax,
                        grid: {
                            color: 'rgba(0, 255, 255, 0.08)',
                            drawBorder: false,
                            lineWidth: 1,
                        },
                        ticks: {
                            color: '#8888aa',
                            font: { family: 'Share Tech Mono', size: 11 },
                            callback: (value) => value + '%'
                        },
                        border: {
                            color: 'rgba(0, 255, 255, 0.3)',
                        },
                        title: {
                            display: true,
                            text: yAxisLabel,
                            color: '#00ffff',
                            font: { family: 'Orbitron', size: 11, weight: 500 }
                        }
                    }
                },
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
            };
        }

        // ============================================================================
        // Details
        // ============================================================================

        // Helper to render performance stats
        function renderPerformanceStats(perf) {
            if (!perf || !perf.avgSearchTimeMs) return '';
            return `
                <div class="detail-row" style="margin-top: 12px; padding-top: 12px; border-top: 1px dashed rgba(0, 255, 255, 0.3);">
                    <span class="detail-label" style="color: var(--neon-yellow); text-shadow: 0 0 8px rgba(255, 255, 0, 0.5);">‚ö° AVG SEARCH</span>
                    <span class="detail-value" style="color: var(--neon-yellow); text-shadow: 0 0 8px rgba(255, 255, 0, 0.5);">${perf.avgSearchTimeMs}ms</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Min / Max</span>
                    <span class="detail-value">${perf.minSearchTimeMs}ms / ${perf.maxSearchTimeMs}ms</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Total Searches</span>
                    <span class="detail-value">${perf.totalSearches}</span>
                </div>
            `;
        }

        function renderNoLiMaDetails(data) {
            const container = document.querySelector('#nolima-details .provider-details');
            const filteredData = data.filter(r => selectedProviders.nolima.has(r.provider));
            
            container.innerHTML = filteredData.map(run => `
                <div class="provider-detail-card">
                    <div class="provider-detail-header">
                        <span class="provider-color" style="background: ${PROVIDER_COLORS[run.provider] || '#6B7280'}; width: 12px; height: 12px; border-radius: 3px;"></span>
                        <span class="provider-detail-name">${run.provider}</span>
                        <span class="provider-detail-meta">${run.runId}</span>
                    </div>
                    <div class="provider-detail-body">
                        <div class="detail-row">
                            <span class="detail-label">Overall Accuracy</span>
                            <span class="detail-value">${run.accuracy.toFixed(2)}%</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Tests</span>
                            <span class="detail-value">${run.totalTests}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Correct Answers</span>
                            <span class="detail-value">${run.correctAnswers}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Answering Model</span>
                            <span class="detail-value">${run.answeringModel}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Judge Model</span>
                            <span class="detail-value">${run.judgeModel || 'N/A'}</span>
                        </div>
                        ${renderPerformanceStats(run.performance)}
                    </div>
                </div>
            `).join('');
        }

        function renderLongMemEvalDetails(data) {
            const container = document.querySelector('#longmemeval-details .provider-details');
            const filteredData = data.filter(r => selectedProviders.longmemeval.has(r.provider));
            
            container.innerHTML = filteredData.map(run => `
                <div class="provider-detail-card">
                    <div class="provider-detail-header">
                        <span class="provider-color" style="background: ${PROVIDER_COLORS[run.provider] || '#6B7280'}; width: 12px; height: 12px; border-radius: 3px;"></span>
                        <span class="provider-detail-name">${run.provider}</span>
                        <span class="provider-detail-meta">${run.runId}</span>
                    </div>
                    <div class="provider-detail-body">
                        <div class="detail-row">
                            <span class="detail-label">Overall Accuracy</span>
                            <span class="detail-value">${run.accuracy.toFixed(2)}%</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Questions</span>
                            <span class="detail-value">${run.totalQuestions}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Correct Answers</span>
                            <span class="detail-value">${run.correctAnswers}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Answering Model</span>
                            <span class="detail-value">${run.answeringModel}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Judge Model</span>
                            <span class="detail-value">${run.judgeModel || 'N/A'}</span>
                        </div>
                        ${renderPerformanceStats(run.performance)}
                    </div>
                </div>
            `).join('');
        }

        function renderLoCoMoDetails(data) {
            const container = document.querySelector('#locomo-details .provider-details');
            const filteredData = data.filter(r => selectedProviders.locomo.has(r.provider));
            
            container.innerHTML = filteredData.map(run => `
                <div class="provider-detail-card">
                    <div class="provider-detail-header">
                        <span class="provider-color" style="background: ${PROVIDER_COLORS[run.provider] || '#6B7280'}; width: 12px; height: 12px; border-radius: 3px;"></span>
                        <span class="provider-detail-name">${run.provider}</span>
                        <span class="provider-detail-meta">${run.runId}</span>
                    </div>
                    <div class="provider-detail-body">
                        <div class="detail-row">
                            <span class="detail-label">Overall Accuracy</span>
                            <span class="detail-value">${run.accuracy.toFixed(2)}%</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Total Questions</span>
                            <span class="detail-value">${run.totalQuestions}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Correct Answers</span>
                            <span class="detail-value">${run.correctAnswers}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Eval Method</span>
                            <span class="detail-value">${run.evalMethod || 'llm'}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Answering Model</span>
                            <span class="detail-value">${run.answeringModel}</span>
                        </div>
                        ${renderPerformanceStats(run.performance)}
                    </div>
                </div>
            `).join('');
        }

        // ============================================================================
        // Start
        // ============================================================================

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

